{% extends "base.html" %}
{% block body %}
<div class="card" style="max-width:720px;margin:28px auto">
  <h1>ğŸ“‹ Play the Game by Filling the Form</h1>
  <p class="lead">Please complete all sections carefully before submitting. 
  <br><small>Note: do not put your real details â€” just fill it randomly.</small></p>

  <form id="f1form" method="POST" action="{{ url_for('f1') }}">
    
    <!-- Personal Information -->
    <h2>ğŸ‘¤ Personal Information</h2>
    <label>Full Name</label>
    <input type="text" name="fullname" class="input" required>
    <div class="error"></div>

    <label>Date of Birth</label>
    <input type="date" name="dob" class="input" required>
    <div class="error"></div>

    <label>Gender</label>
    <div class="group">
      <label><input type="radio" name="gender" value="Male" required> Male</label>
      <label><input type="radio" name="gender" value="Female"> Female</label>
      <label><input type="radio" name="gender" value="Other"> Other</label>
    </div>
    <div class="error"></div>

    <label>Marital Status</label>
    <div class="group">
      <label><input type="radio" name="marital" value="Single" required> Single</label>
      <label><input type="radio" name="marital" value="Married"> Married</label>
      <label><input type="radio" name="marital" value="Divorced"> Divorced</label>
      <label><input type="radio" name="marital" value="Widowed"> Widowed</label>
    </div>
    <div class="error"></div>

    <hr>

    <!-- Residential Address -->
    <h2>ğŸ  Residential Address</h2>
    <label>Street</label>
    <input type="text" name="street" class="input" required>
    <div class="error"></div>

    <label>City</label>
    <input type="text" name="city" class="input" required>
    <div class="error"></div>

    <label>Postal Code</label>
    <input type="text" name="postal" class="input" required>
    <div class="error"></div>

    <label>Country</label>
    <input type="text" name="country" class="input" required>
    <div class="error"></div>

    <hr>

    <!-- Education -->
    <h2>ğŸ“ Education Background</h2>
    <label>Highest Qualification</label>
    <input type="text" name="qualification" class="input" required>
    <div class="error"></div>

    <label>Institution</label>
    <input type="text" name="institution" class="input" required>
    <div class="error"></div>

    <label>Year Completed</label>
    <input type="number" name="year_completed" class="input" required>
    <div class="error"></div>

    <hr>

    <!-- Work -->
    <h2>ğŸ’¼ Work / Business Information</h2>
    <label>Occupation / Job Title</label>
    <input type="text" name="occupation" class="input" required>
    <div class="error"></div>

    <label>Company / Business Name</label>
    <input type="text" name="company" class="input" required>
    <div class="error"></div>

    <hr>

    <!-- Fun Preferences -->
    <h2>ğŸ’° Fun Preferences</h2>
    <div class="group">
      <label><input type="checkbox" name="fun" value="happiness" required> Feel from your own happiness</label><br>
      <label><input type="checkbox" name="fun" value="smile"> Earn from your smile</label><br>
      <label><input type="checkbox" name="fun" value="both"> Both</label>
    </div>
    <div class="error"></div>

    <hr>

    <!-- Short Bio -->
    <h2>ğŸ“ Short Bio</h2>
    <textarea name="bio" class="input" rows="6" minlength="15" maxlength="1500" required placeholder="Please write 15â€“300 words explaining why you want to play your social media account."></textarea>
    <div class="error"></div>

    <hr>

    <!-- Notifications -->
    <h2>ğŸ”” Notification Preferences</h2>
    <div class="group">
      <label><input type="checkbox" name="notify" value="email" required> Email Updates</label><br>
      <label><input type="checkbox" name="notify" value="sms"> SMS Alerts</label><br>
      <label><input type="checkbox" name="notify" value="push"> Push Notifications</label>
    </div>
    <div class="error"></div>

    <hr>

    <!-- Play Method -->
    <h2>ğŸ’³ Play Method</h2>
    <div class="group">
      <label><input type="radio" name="method" value="feeling" required> Feeling</label><br>
      <label><input type="radio" name="method" value="hoping"> Hoping</label><br>
      <label><input type="radio" name="method" value="applications"> Applications</label>
    </div>
    <div class="error"></div>

    <hr>

    <!-- Terms -->
    <h2>ğŸ“„ Terms & Conditions</h2>
    <div style="max-height:100px;overflow:auto;border:1px solid #ddd;padding:10px;border-radius:8px;font-size:14px;">
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non eros ut elit suscipit cursus. 
      Curabitur a sapien at est bibendum porttitor. Suspendisse potenti. Etiam ac tristique nulla.</p>
    </div>
    <label><input type="checkbox" name="terms" required> I have read and agree to the Terms & Conditions.</label>
    <div class="error"></div>

    <hr>

    <!-- Submit -->
    <div class="center">
      <button type="submit" class="btn btn-blue">âœ… Submit</button>
    </div>
  </form>
</div>

<style>
.error {
  color: red;
  font-size: 0.85em;
  margin: 4px 0 12px;
  display: none;
}
.input.error-field {
  border: 2px solid red;
}
</style>

<script>
document.getElementById("f1form").addEventListener("submit", function(e) {
  let form = this;
  let firstInvalid = null;
  let valid = true;

  // Clear previous errors
  form.querySelectorAll(".error").forEach(err => err.style.display = "none");
  form.querySelectorAll(".error-field").forEach(el => el.classList.remove("error-field"));

  // Validation messages
  const messages = {
    fullname: "Please enter your full name",
    dob: "Please select your date of birth",
    gender: "Please select your gender",
    marital: "Please choose your marital status",
    street: "Enter your street address",
    city: "Enter your city",
    postal: "Enter your postal code",
    country: "Enter your country",
    qualification: "Enter your highest qualification",
    institution: "Enter your institution name",
    year_completed: "Enter the year you completed",
    occupation: "Enter your occupation or job title",
    company: "Enter your company or business name",
    fun: "Select at least one fun preference",
    bio: "Write a short bio (15â€“300 words)",
    notify: "Select at least one notification preference",
    method: "Choose a play method",
    terms: "You must agree to the Terms & Conditions"
  };

  // Check each required field/group
  form.querySelectorAll("[required]").forEach(el => {
    let groupName = el.name;
    let errorBox = el.closest(".group")?.nextElementSibling || el.nextElementSibling;
    let isValid = true;

    if (el.type === "radio" || el.type === "checkbox") {
      let group = form.querySelectorAll(`[name="${groupName}"]`);
      isValid = Array.from(group).some(i => i.checked);
    } else {
      isValid = el.value.trim() !== "";
    }

    if (!isValid) {
      valid = false;
      if (errorBox && errorBox.classList.contains("error")) {
        errorBox.textContent = messages[groupName] || "This field is required";
        errorBox.style.display = "block";
      }
      if (!firstInvalid) firstInvalid = el;
      el.classList.add("error-field");
    }
  });

  if (!valid) {
    e.preventDefault();
    if (firstInvalid) {
      firstInvalid.scrollIntoView({behavior: "smooth", block: "center"});
      firstInvalid.focus({preventScroll:true});
    }
  }
});
</script>
{% endblock %}
