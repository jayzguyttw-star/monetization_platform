{% extends "base.html" %}
{% block body %}
<div class="card form-card">
  <h1>üìã Play the Game by Filling the Form</h1>
  <p class="lead">Please complete all sections carefully before submitting. 
  <br><small>Note: do not put your real details ‚Äî just fill it randomly.</small></p>

  <form id="f1form" method="POST" action="{{ url_for('f1') }}" novalidate>
    <!-- PERSONAL INFORMATION -->
    <h2 class="section-title">üë§ Personal Information</h2>
    <label class="subheading">Full Name</label>
    <input class="input" name="fullname" required>
    <div class="error-text"></div>

    <label class="subheading">Date of Birth</label>
    <input class="input" type="date" name="dob" required>
    <div class="error-text"></div>

    <label class="subheading">Gender</label>
    <div class="button-group" data-name="gender">
      <button type="button" class="option-btn" data-value="Male">Male</button>
      <button type="button" class="option-btn" data-value="Female">Female</button>
      <button type="button" class="option-btn" data-value="Other">Other</button>
      <input type="hidden" name="gender" required>
    </div>
    <div class="error-text"></div>

    <label class="subheading">Marital Status</label>
    <div class="button-group" data-name="marital">
      <button type="button" class="option-btn" data-value="Single">Single</button>
      <button type="button" class="option-btn" data-value="Married">Married</button>
      <button type="button" class="option-btn" data-value="Divorced">Divorced</button>
      <button type="button" class="option-btn" data-value="Widowed">Widowed</button>
      <input type="hidden" name="marital" required>
    </div>
    <div class="error-text"></div>

    <hr>

    <!-- RESIDENTIAL -->
    <h2 class="section-title">üè† Residential Address</h2>
    <label class="subheading">Street</label>
    <input class="input" name="street" required>
    <div class="error-text"></div>

    <label class="subheading">City</label>
    <input class="input" name="city" required>
    <div class="error-text"></div>

    <label class="subheading">Postal Code</label>
    <input class="input" name="postal" required>
    <div class="error-text"></div>

    <label class="subheading">Country</label>
    <input class="input" name="country" required>
    <div class="error-text"></div>

    <hr>

    <!-- EDUCATION -->
    <h2 class="section-title">üéì Education Background</h2>
    <label class="subheading">Highest Qualification</label>
    <input class="input" name="qualification" required>
    <div class="error-text"></div>

    <label class="subheading">Institution</label>
    <input class="input" name="institution" required>
    <div class="error-text"></div>

    <label class="subheading">Year Completed</label>
    <input class="input" type="number" name="year_completed" required>
    <div class="error-text"></div>

    <hr>

    <!-- WORK -->
    <h2 class="section-title">üíº Work / Business Information</h2>
    <label class="subheading">Occupation / Job Title</label>
    <input class="input" name="occupation" required>
    <div class="error-text"></div>

    <label class="subheading">Company / Business Name</label>
    <input class="input" name="company" required>
    <div class="error-text"></div>

    <hr>

    <!-- FUN PREFERENCES -->
    <h2 class="section-title">üí∞ Fun Preferences</h2>
    <div class="button-group" data-name="fun">
      <button type="button" class="option-btn" data-value="happiness">Feel from your own happiness</button>
      <button type="button" class="option-btn" data-value="smile">Earn from your smile</button>
      <button type="button" class="option-btn" data-value="both">Both</button>
      <input type="hidden" name="fun" required>
    </div>
    <div class="error-text"></div>

    <hr>

    <!-- SHORT BIO -->
    <h2 class="section-title">üìù Short Bio</h2>
    <textarea class="input" name="bio" rows="5" minlength="15" maxlength="1500" required placeholder="Write 15‚Äì300 words..."></textarea>
    <div class="error-text"></div>

    <hr>

    <!-- NOTIFICATIONS -->
    <h2 class="section-title">üîî Notification Preferences</h2>
    <div class="button-group" data-name="notify">
      <button type="button" class="option-btn" data-value="email">Email Updates</button>
      <button type="button" class="option-btn" data-value="sms">SMS Alerts</button>
      <button type="button" class="option-btn" data-value="push">Push Notifications</button>
      <input type="hidden" name="notify" required>
    </div>
    <div class="error-text"></div>

    <hr>

    <!-- PLAY METHOD -->
    <h2 class="section-title">üí≥ Play Method</h2>
    <div class="button-group" data-name="method">
      <button type="button" class="option-btn" data-value="feeling">Feeling</button>
      <button type="button" class="option-btn" data-value="hoping">Hoping</button>
      <button type="button" class="option-btn" data-value="applications">Applications</button>
      <input type="hidden" name="method" required>
    </div>
    <div class="error-text"></div>

    <hr>

    <!-- TERMS -->
    <h2 class="section-title">üìÑ Terms & Conditions</h2>
    <div class="terms-box">
      <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec non eros ut elit suscipit cursus. 
      Curabitur a sapien at est bibendum porttitor. Suspendisse potenti.</p>
    </div>
    <label><input type="checkbox" name="terms"> I have read and agree to the Terms & Conditions.</label>
    <div class="error-text"></div>

    <hr>

    <button type="submit" class="btn">‚úÖ Submit</button>
  </form>
</div>

<style>
.form-card {
  max-width: 720px;
  margin: 28px auto;
  padding: 32px;
  border-radius: 16px;
  background: #fff;
  box-shadow: 0 12px 28px rgba(24,119,242,0.25);
}
.input {
  width: 100%;
  padding: 14px;
  border-radius: 14px;
  border: 1px solid #e5e7eb;
  margin-bottom: 8px;
  font-size: 16px;
  transition: border-color 0.2s, box-shadow 0.2s;
}
.input:focus {
  border-color: #1877F2;
  box-shadow: 0 0 0 3px rgba(24,119,242,0.25);
  outline: none;
}
.input-error {
  border-color: #ef4444;
  box-shadow: 0 0 0 3px rgba(239,68,68,0.15);
}
.option-btn {
  padding: 10px 18px;
  border-radius: 12px;
  border: 1px solid #ccc;
  background: #e5e7eb;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.25s ease;
}
.option-btn.selected {
  background: #1877F2;
  color: #fff;
  box-shadow: 0 4px 12px rgba(24,119,242,0.35);
}
.option-btn:hover { box-shadow: 0 6px 16px rgba(24,119,242,0.25); }
.button-group { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 8px; }
.error-text {
  color: #ef4444;
  font-size: 13px;
  margin-top: -4px;
  margin-bottom: 8px;
}
.btn {
  width: 100%;
  background: #1877F2;
  color: #fff;
  font-size: 16px;
  font-weight: 700;
  padding: 12px;
  border-radius: 25px;
  cursor: pointer;
  border: none;
  transition: background 0.25s, transform 0.1s, box-shadow 0.2s;
  box-shadow: 0 6px 16px rgba(24,119,242,0.35);
}
.btn:hover { background: #166fe5; box-shadow: 0 8px 20px rgba(24,119,242,0.45); }
.btn:active { transform: scale(0.985); }
</style>

<script>
const form = document.getElementById("f1form");

// Handle button group selections
document.querySelectorAll(".button-group").forEach(group => {
  group.querySelectorAll(".option-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      group.querySelectorAll(".option-btn").forEach(b => b.classList.remove("selected"));
      btn.classList.add("selected");
      group.querySelector("input[type='hidden']").value = btn.dataset.value;
    });
  });
});

form.addEventListener("submit", e => {
  let valid = true;
  let firstInvalid = null;

  form.querySelectorAll(".input, textarea").forEach(input => {
    const errorText = input.nextElementSibling;
    input.classList.remove("input-error");
    if (errorText) errorText.textContent = "";

    if (input.hasAttribute("required") && !input.value.trim()) {
      valid = false;
      input.classList.add("input-error");
      if (errorText) errorText.textContent = "This field is required.";
      if (!firstInvalid) firstInvalid = input;
    }
  });

  // Hidden fields (button groups)
  form.querySelectorAll(".button-group").forEach(group => {
    const hidden = group.querySelector("input[type='hidden']");
    const errorText = group.nextElementSibling;
    if (!hidden.value) {
      valid = false;
      if (errorText) errorText.textContent = "Please make a selection.";
      if (!firstInvalid) firstInvalid = group;
    } else {
      if (errorText) errorText.textContent = "";
    }
  });

  // Terms checkbox
  const terms = form.querySelector("input[name='terms']");
  const termsError = terms.parentElement.nextElementSibling;
  if (!terms.checked) {
    valid = false;
    if (termsError) termsError.textContent = "You must agree before continuing.";
    if (!firstInvalid) firstInvalid = terms;
  } else {
    if (termsError) termsError.textContent = "";
  }

  if (!valid) {
    e.preventDefault();
    firstInvalid.scrollIntoView({ behavior: "smooth", block: "center" });
  }
});

// Real-time validation clearing
form.querySelectorAll(".input, textarea").forEach(input => {
  input.addEventListener("input", () => {
    input.classList.remove("input-error");
    const errorText = input.nextElementSibling;
    if (errorText) errorText.textContent = "";
  });
});
</script>
{% endblock %}
